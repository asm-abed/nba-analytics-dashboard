if 'transformer' not in globals():
    from mage_ai.data_preparation.decorators import transformer
if 'test' not in globals():
    from mage_ai.data_preparation.decorators import test
import pandas as pd
from datetime import date, timedelta


@transformer
def transform(data, *args, **kwargs):
    df = pd.DataFrame(data)
    
    df = df.drop(columns = ['NICKNAME', 'START_POSITION', 'COMMENT', 'TEAM_CITY', 'TEAM_ID'])

    df.rename(columns={
        'MIN': 'mins_played',
        'FGM': 'field_goal_made',
        'FGA': 'field_goal_attempt',
        'FG_PCT': 'field_goal_pct',
        'FG3M': 'three_pt_made',
        'FG3A': 'three_pt_attempt',
        'FG3_PCT': 'three_pt_pct',
        'FTM': 'free_throw_made',
        'FTA': 'free_throw_attempt',
        'FT_PCT': 'free_throw_pct',
        'PLUS_MINUS': 'plusminus',
        'TO':'TOV',
        'GAME_ID': 'game_id',
        'PLAYER_ID':'player_id',
        'TEAM_ABBREVIATION':'team',
        'PLAYER_NAME':'player'
        }, inplace=True)


    df['mins_played']=df['mins_played'].str.split(':').str[0].astype(float).astype(int)
        
    if (date.today() - timedelta(days=2)) >= '2024-04-16':
        df['season_id'] = 


    # Specify your transformation logic here

    return df


@test
def test_output(output, *args) -> None:
    """
    Template code for testing the output of the block.
    """
    assert output is not None, 'The output is undefined'